<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tournaments</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700&display=swap" rel="stylesheet">
    <style>body { font-family: 'Rajdhani', sans-serif; }</style>
</head>
<body class="bg-gray-900 text-white min-h-screen p-4">

    <!-- Header -->
    <div class="flex items-center mb-6">
        <a href="/home" class="bg-gray-800 p-2 rounded-lg hover:bg-gray-700 mr-4 border border-gray-600"><i class="fa-solid fa-arrow-left"></i></a>
        <h1 id="catTitle" class="text-2xl font-bold text-blue-400">Loading...</h1>
    </div>

    <!-- Tournament List -->
    <div id="tList" class="space-y-4">
        <p class="text-center text-gray-500 py-10 animate-pulse">Loading matches...</p>
    </div>

    <script>
        async function loadTournaments() {
            const urlParams = new URLSearchParams(window.location.search);
            const catId = urlParams.get('id');
            if(!catId) window.location.href = '/home';

            // API কল (নতুন API বানাতে হবে)
            const res = await fetch('/api/user/category-tournaments', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ catId })
            });
            const data = await res.json();

            document.getElementById('catTitle').innerText = data.category.title;
            const list = document.getElementById('tList');
            list.innerHTML = '';

            if(data.tournaments.length === 0) {
                list.innerHTML = '<p class="text-center text-gray-500">No tournaments available right now.</p>';
                return;
            }

            data.tournaments.forEach(t => {
                let statusColor = t.status === 'open' ? 'text-green-400' : 'text-red-400';
                
                list.innerHTML += `
                    <div class="bg-gray-800 rounded-xl overflow-hidden shadow-lg border border-gray-700">
                        <div class="relative h-32">
                            <img src="${t.image || 'https://via.placeholder.com/400x200'}" class="w-full h-full object-cover">
                            <div class="absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 hover:opacity-100 transition duration-300">
                                <button onclick="window.location.href='/tournament-details?id=${t.id}'" class="bg-blue-600 text-white px-6 py-2 rounded-full font-bold shadow-lg transform hover:scale-105 transition">View Details</button>
                            </div>
                        </div>
                        <div class="p-4">
                            <div class="flex justify-between items-start mb-2">
                                <h3 class="font-bold text-lg text-white leading-tight w-3/4">${t.title}</h3>
                                <span class="text-xs font-bold ${statusColor} border border-gray-600 px-2 py-1 rounded uppercase">${t.status}</span>
                            </div>
                            <div class="flex justify-between text-sm text-gray-400 mt-3 border-t border-gray-700 pt-2">
                                <span><i class="fa-solid fa-coins text-yellow-500 mr-1"></i> Prize: ৳${t.prize_pool}</span>
                                <span><i class="fa-solid fa-ticket text-green-500 mr-1"></i> Fee: ৳${t.entry_fee}</span>
                            </div>
                            <button onclick="window.location.href='/tournament-details?id=${t.id}'" class="w-full mt-3 bg-gray-700 hover:bg-gray-600 text-white py-2 rounded-lg font-bold text-sm transition">
                                JOIN MATCH
                            </button>
                        </div>
                    </div>
                `;
            });
        }
        loadTournaments();
    </script>
</body>
</html>
